# cli: data-replicator configs/cross_metastore/recon_override_example.yaml -o reconciliation
# Hierarchical config override. replication_group -> target_catalog -> target_schema -> table

version: "1.0"

replication_group: "recon_all_tables_defaults"

source_databricks_connect_config:
  name: "azure"
  host: "https://adb-984752964297111.11.azuredatabricks.net"

target_databricks_connect_config:
  name: "aws"
  host: "https://e2-demo-field-eng.cloud.databricks.com"

audit_config:
  audit_table: "data_replication.audit.audit_logging"

table_types: ["all"]

reconciliation_config:
  enabled: true
  exclude_columns: []
  source_filter_expression: ""
  target_filter_expression: ""
  schema_check: true
  row_count_check: true
  missing_data_check: true
  thresholds: 99

target_catalogs:
  - catalog_name: "enterprise"
    sample_size: 1000
    reconciliation_config:
      source_catalog: enterprise_aws_shared
      thresholds: 80
    target_schemas:
      - schema_name: "bronze_0907"
        layer: "bronze"
        sample_size: 500
        reconciliation_config:
          missing_data_check: false
          thresholds: 50
        tables:
          - table_name: "events"
            reconciliation_config:
              row_count_check: true
              missing_data_check: true
              thresholds: 90
          - table_name: "pageviews"
            reconciliation_config:
              row_count_check: false
              missing_data_check: true
              thresholds: 85
      - schema_name: "bronze_0915"
        layer: "bronze"
        sample_size: 800
        reconciliation_config:
          row_count_check: false
          missing_data_check: false
          thresholds: 60
      - schema_name: "silver"
        layer: "silver"
        reconciliation_config:
          missing_data_check: false
          thresholds: 70
      - schema_name: "gold"
        layer: "gold"

concurrency:
  max_workers: 5
  timeout_seconds: 1800

retry:
  max_attempts: 2
  retry_delay_seconds: 3
